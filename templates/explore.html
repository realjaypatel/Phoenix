{% include 'includes/topbar.html' %} {% include 'includes/navbar.html' %}

<div class="content">
  <div class="border-bottom border-translucent mx-n4 mx-lg-n6 px-4 px-lg-6 pb-5">
    <div class="row justify-content-between gy-4">
      <div class="col-auto">
        <h2>Search <span class="text-body-tertiary fw-semibold"></span></h2>
      </div>
      <div class="col-auto d-flex flex-wrap gap-2">
        <div class="search-box">
          <form class="position-relative" id="searchForm2">
            <input class="form-control search-input search" type="search"
              placeholder="Search by name" aria-label="Search" id="searchInput2">
            <svg class="svg-inline--fa fa-magnifying-glass search-box-icon" aria-hidden="true" focusable="false"
              data-prefix="fas" data-icon="magnifying-glass" role="img" xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512" data-fa-i2svg="">
              <path fill="currentColor"
                d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z">
              </path>
            </svg><!-- <span class="fas fa-search search-box-icon"></span> Font Awesome fontawesome.com -->
          </form>
        </div>
      </div>
    </div>
  </div>

  <h3 class="mb-3 mt-3">Business</h3>
  <div class="border-top border-translucent">
    <div id="purchasersSellersTable"
      data-list='{"valueNames":["deals_name","deal_owner","account_name","stage","amount"],"page":10,"pagination":true}'>
      <div class="table-responsive scrollbar mx-n1 px-1">
        <table class="table table-sm fs-9 leads-table">
          <thead>
            <tr>
              <th class="white-space-nowrap fs-9 align-middle ps-0" style="max-width: 20px; width: 18px">
                <div class="form-check mb-0 fs-8">
                  <input class="form-check-input" type="checkbox"
                    data-bulk-select='{"body":"purchasers-sellers-body"}' />
                </div>
              </th>
              <th class="sort align-middle ps-0 pe-5 text-uppercase text-nowrap" scope="col" data-sort="deals_name"
                style="min-width: 120px">
                Deal name
              </th>
              <th class="sort align-middle ps-4 pe-5 text-uppercase text-nowrap" scope="col" data-sort="deal_owner"
                style="min-width: 50px">
                Deal owner
              </th>
              <th class="sort align-middle ps-4 pe-5 text-uppercase text-nowrap" scope="col" data-sort="account_name"
                style="min-width: 250px">
                Account name
              </th>
              <th class="sort align-middle pe-5 text-uppercase text-nowrap" scope="col" data-sort="stage"
                style="min-width: 160px">
                Stage
              </th>
              <th class="sort align-middle ps-4 pe-5 text-uppercase text-nowrap" scope="col" data-sort="amount"
                style="min-width: 50px">
                Amount
              </th>
              <th class="sort text-end align-middle pe-0 ps-4" scope="col"></th>
            </tr>
          </thead>
          <tbody class="list" id="purchasers-sellers-body">
            {% for d in data %}
            <tr class="hover-actions-trigger btn-reveal-trigger position-static">
              <td class="fs-9 align-middle py-0">
                <div class="form-check mb-0 fs-8">
                  <input class="form-check-input" type="checkbox"
                    data-bulk-select-row='{"dealsName":"Jo_Td01","dealOwner":{"avatar":"team/avatar.webp","name":"Ally Aagaard","placeholder":true},"accountName":"Themewagon","stage":{"label":"Analysis","color":"#3874FF","data":20},"amount":{"totalAmount":"$140","icon":"trending-down","color":"text-danger"}}' />
                </div>
              </td>
              <td class="deals_name align-middle white-space-nowrap fw-semibold text-body-highlight ps-0 py-0">
                <a class="fw-bold text-primary" href="/business/{{d.Id}}">{{d.Title}}</a>
              </td>
              <td class="deal_owner align-middle white-space-nowrap fw-semibold text-body-emphasis ps-4 py-0">
                <div class="d-flex align-items-center position-relative">
                  <div class="avatar avatar-m me-3">
                    <img class="rounded-circle avatar-placeholder" src="assets/img/team/avatar.webp" alt="" />
                  </div>
                  <a class="text-body-highlight fw-bold stretched-link" href="#!">Ally Aagaard</a>
                </div>
              </td>
              <td class="account_name align-middle white-space-nowrap ps-4 fw-semibold text-body py-0">
                Themewagon
              </td>
              <td class="stage align-middle white-space-nowrap fw-bold text-body py-2">
                <div class="d-flex align-items-center gap-3">
                  <div style="--phoenix-circle-progress-bar: 20">
                    <svg class="circle-progress-svg" width="38" height="38" viewBox="0 0 125 125">
                      <circle class="progress-bar-rail" cx="65" cy="45" r="54" fill="none" stroke-linecap="round"
                        stroke-width="15"></circle>
                      <circle class="progress-bar-top" cx="65" cy="45" r="54" fill="none" stroke-linecap="round"
                        stroke="#3874FF" stroke-width="12"></circle>
                    </svg>
                  </div>
                  <h6 class="mb-0 text-body">Analysis</h6>
                </div>
              </td>
              <td class="amount align-middle white-space-nowrap fw-bold ps-4 text-body py-0">
                $140<svg xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="feather feather-trending-down ms-2 text-danger" style="min-height: 8px; width: 14px">
                  <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                  <polyline points="17 18 23 18 23 12"></polyline>
                </svg>
              </td>
              <td class="align-middle white-space-nowrap text-end pe-0 ps-4">
                <div class="btn-reveal-trigger position-static">
                  <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs-10"
                    type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true"
                    aria-expanded="false" data-bs-reference="parent">
                    <svg class="svg-inline--fa fa-ellipsis fs-10" aria-hidden="true" focusable="false" data-prefix="fas"
                      data-icon="ellipsis" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"
                      data-fa-i2svg="">
                      <path fill="currentColor"
                        d="M8 256a56 56 0 1 1 112 0A56 56 0 1 1 8 256zm160 0a56 56 0 1 1 112 0 56 56 0 1 1 -112 0zm216-56a56 56 0 1 1 0 112 56 56 0 1 1 0-112z">
                      </path>
                    </svg><!-- <span class="fas fa-ellipsis-h fs-10"></span> Font Awesome fontawesome.com -->
                  </button>
                  <div class="dropdown-menu dropdown-menu-end py-2">
                    <a class="dropdown-item" href="#!">View</a><a class="dropdown-item" href="#!">Export</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item text-danger" href="#!">Remove</a>
                  </div>
                </div>
              </td>
            </tr>
            {%endfor%}

          </tbody>
        </table>
      </div>
      <div class="row align-items-center justify-content-between pe-0 fs-9">

        <div class="mt-2" style="
        display: flex;
        flex-direction: row;
        justify-content: center;
    ">

          <ul class="pagination" id="pagination">

          </ul>

        </div>
      </div>
    </div>
  </div>
</div>
{% include 'includes/bottombar.html' %}

<script>
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return parseInt(urlParams.get(param)) || 1;
  }

  function createPagination(currentPage, totalPages) {
    const pagination = document.getElementById('pagination');
    pagination.innerHTML = '';

    const createPageItem = (page, text = page) => {
      const li = document.createElement('li');
      li.className = 'page-item' + (page === currentPage ? ' active' : '');
      const a = document.createElement('a');
      a.className = 'page-link';
      a.href = `?p=${page}`;
      a.textContent = text;
      li.appendChild(a);
      return li;
    };

    if (currentPage > 1) {
      pagination.appendChild(createPageItem(currentPage - 1, '«'));
    }

    for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
      pagination.appendChild(createPageItem(i));
    }

    if (currentPage < totalPages) {
      pagination.appendChild(createPageItem(currentPage + 1, '»'));
    }
  }

  const currentPage = getQueryParam('p');
  const totalPages = 50; // Change this to your total number of pages
  createPagination(currentPage, totalPages);
</script>

<script>
	document.getElementById('searchForm2').addEventListener('submit', function(event) {
		event.preventDefault(); // Prevent the default form submission
		const searchText = document.getElementById('searchInput2').value;
		window.location.href = `/explore/${encodeURIComponent(searchText)}`;
	});
</script>